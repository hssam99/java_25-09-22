package f1_project;

import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
import java.util.Random;
import java.util.Scanner;
import java.util.stream.Collectors;

// 기타 게임 컨트롤러
public class GameController {
	
	DotArtController dac = new DotArtController();
	Random random = new Random();
	Scanner sc = new Scanner(System.in);
	
	
	
    public void printRandomMessagesAfterCourse(int courseType) { // 1-직선 2-곡선 3-유턴
        List<String> msgs = new ArrayList<>(); // 리스트 생성

        switch (courseType) {
            case 1: // 직선
            	
                msgs.add("관중석에서 함성이 커집니다! "+CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+ " 멋진 스타트!");
                msgs.add("속도계를 보세요! "+CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+" 엄청난 가속입니다!");
                msgs.add("바퀴가 포장도로를 움켜쥐며 비명을 지릅니다!");
                msgs.add(CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+" 코너 진입! 순식간에 순위가 바뀔 수 있습니다!");
                msgs.add("팬들의 응원이 "+ CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName() +" 선수에게 힘을 실어주고 있습니다!");
                msgs.add(CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+"의 엄청난 직선 스피드! 엔진이 한계까지 몰아붙여집니다!");
                msgs.add(CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+" 선수가 DRS를 열고 최대 가속을 뽑아냅니다!");
                break;

            case 2:  // 곡선
                msgs.add(CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+" 정확한 라인! 한 치의 오차도 허용되지 않습니다!");
                msgs.add("좌우로 흔들리며 "+CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+" 선수의 차체가 극한의 밸런스를 보여줍니다!");
                msgs.add("이 구간을 완벽히 통과하면 "+CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+" 엄청난 랩타임 단축이 가능합니다!");
                msgs.add("속도를 잃지 않고 연속 코너를 이어가는 "+CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName() +" 드라이버의 놀라운 컨트롤!");
                msgs.add(CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+"! 작은 실수 하나가 치명적인 결과로 이어질 수 있습니다!");
                msgs.add("관중석에서도 숨을 죽이고 지켜보고 있습니다!");
                msgs.add(CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+"선수 위험합니다. 리듬을 잃지 않는 집중력이 핵심입니다!");
                break;

            case 3: // 유턴
            	msgs.add(CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+" 이상적인 터닝 포인트를 정확히 찍었습니다!");
                msgs.add("라인 유지가 승부의 갈림길입니다!"+CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+"선수의 환상적인 플레이!");
                msgs.add(CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+" 추월 시도! 누가 먼저 브레이킹 포인트를 선점할까요?");
                msgs.add(CircuitController.pc.driverListForGrandPix.get(random.nextInt(2)).getDriverName()+"! 루이스 해밀턴과 사이드 바이 사이드! 두 차량이 나란히 달립니다!");
                msgs.add("한계까지 밀어붙이는 "+CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+" 드라이버의 용기에 박수가 터져나옵니다!");
                msgs.add(CircuitController.pc.driverListForGrandPix.get(random.nextInt(4)).getDriverName()+"!!! 다음 코너를 위한 최적의 포지션을 노립니다!");
                break;

            default:
                // 예비 공통 멘트
            	msgs.add("관중들이 자리에서 일어나 손을 흔들고 있습니다!");
                msgs.add("팀 라디오로 전략을 조율하고 있습니다!");
                msgs.add("타이어 온도를 정교하게 관리하는 모습입니다!");
        }
        
        Collections.shuffle(msgs); // 
        int count = 2 + random.nextInt(2); // 2~3개
        for (int i = 0; i < count && i < msgs.size(); i++) {
            printStringOnebyOne(msgs.get(i));
        }
    }
	
	
	
	
	public void printLoadingDot() throws InterruptedException {
		System.out.print(".");
		Thread.sleep(50);
		System.out.print(".");
		Thread.sleep(50);
		System.out.print(".");
		Thread.sleep(50);
		Thread.sleep(10);
		System.out.println();
		System.out.println();
		System.out.println();
	}	// printLoadingDot

	
	public void printStringOnebyOne(String text) {
    	for (int i = 0; i < text.length(); i++) {
			System.out.print(text.charAt(i)); // 한 글자 출력
			System.out.flush();              // 출력 즉시 반영
			try {
				Thread.sleep(10); // 0.1초 대기
			} catch (InterruptedException e) {
				e.printStackTrace();
			}              
		}
    	System.out.println();
    	
    }
	
	
	
	
	
	public void printChampionshipDriver() {
		dac.printGrandPrixStandingImage();
		System.out.println("RANK \t DRIVER \t\t TEAM \t\t\t POINT");
		System.out.println("-------------------------------------------------------------------------------------");
		System.out.println();
		
		
    	int prevDriverPoint = 0;
    	int prevRank = 1;
    	
    	List<Driver> sortedList =  
    			CircuitController.pc.driverListForGrandPix
        	    .stream()
        	    .sorted((a, b) -> Integer.compare(b.getDriverPoint(), a.getDriverPoint()))
        	    .collect(Collectors.toList());
    	
    	
    	for(Driver d : sortedList) {
    		if(d.getDriverPoint()==prevDriverPoint) { // 앞 인덱스의 드라이버와 동일한 점수일 경우 (동점일경우)
    			d.setDriverRank(prevRank-1);
    			prevRank++;
    		}else {
    			d.setDriverRank(prevRank);
    			prevRank++;
    		}
    		
    		System.out.println(d.getDriverRank()+" \t "+d.getDriverName()+" \t\t "+d.getConstructor()+" \t\t "+d.getDriverPoint());
    		System.out.println();
    	}
		
		
		
		System.out.println();
		System.out.println("=====================================================================================");
		
	}	// printChampionshipDriver

	public void printChampionshipConstructor() {
		System.out.println("랭킹 	팀이름	컨스트럭터 포인트");
		dac.printGrandPrixStandingImage();
		System.out.println("RANK \t TEAM \t\t\t POINT");
		System.out.println("-------------------------------------------------------------------------------------");
		System.out.println();
		
    	int prevConstructorPoint = 0;
    	int prevRank = 1;
    	
    	List<Constructor> sortedList =  
    			CircuitController.pc.constructorList
        	    .stream()
        	    .sorted((a, b) -> Integer.compare(b.getConstructorPoint(), a.getConstructorPoint()))
        	    .collect(Collectors.toList());
    	
    	
    	for(Constructor c : sortedList) {
    		if(c.getConstructorPoint()==prevConstructorPoint) { // 앞 인덱스의 드라이버와 동일한 점수일 경우 (동점일경우)
    			c.setConstructorRank(prevRank-1);
    			prevRank++;
    		}else {
    			c.setConstructorRank(prevRank);
    			prevRank++;
    		}
    		
    		System.out.println(c.getConstructorRank()+" \t "+c.getConstructorName()+"\t\t "+c.getConstructorPoint());
    		System.out.println();
    	}
		
		
		
		System.out.println();
		System.out.println("=====================================================================================");
		
	}	// printChampionshipConstructor
	
	
	

}
